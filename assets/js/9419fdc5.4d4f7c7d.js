"use strict";(self.webpackChunk_orca_so_whirlpools_docs=self.webpackChunk_orca_so_whirlpools_docs||[]).push([[5296],{95:(e,n,t)=>{t.d(n,{A:()=>x});var r=t(4041),o=t(4357),i=t(5245),l=t(6090),a=t(3190),s=t(838),c=t(6423),d=t(6326);function u(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:t,attributes:r,default:o}}=e;return{value:n,label:t,attributes:r,default:o}}))}(t);return function(e){const n=(0,c.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function h(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function g(e){let{queryString:n=!1,groupId:t}=e;const o=(0,l.W6)(),i=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,s.aZ)(i),(0,r.useCallback)((e=>{if(!i)return;const n=new URLSearchParams(o.location.search);n.set(i,e),o.replace({...o.location,search:n.toString()})}),[i,o])]}function m(e){const{defaultValue:n,queryString:t=!1,groupId:o}=e,i=p(e),[l,s]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!h({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=t.find((e=>e.default))??t[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:i}))),[c,u]=g({queryString:t,groupId:o}),[m,f]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[o,i]=(0,d.Dv)(t);return[o,(0,r.useCallback)((e=>{t&&i.set(e)}),[t,i])]}({groupId:o}),_=(()=>{const e=c??m;return h({value:e,tabValues:i})?e:null})();(0,a.A)((()=>{_&&s(_)}),[_]);return{selectedValue:l,selectValue:(0,r.useCallback)((e=>{if(!h({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);s(e),u(e),f(e)}),[u,f,i]),tabValues:i}}var f=t(1310);const _={tabList:"tabList_M0Dn",tabItem:"tabItem_ysIP"};var b=t(1085);function k(e){let{className:n,block:t,selectedValue:r,selectValue:l,tabValues:a}=e;const s=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.a_)(),d=e=>{const n=e.currentTarget,t=s.indexOf(n),o=a[t].value;o!==r&&(c(n),l(o))},u=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=s.indexOf(e.currentTarget)+1;n=s[t]??s[0];break}case"ArrowLeft":{const t=s.indexOf(e.currentTarget)-1;n=s[t]??s[s.length-1];break}}n?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.A)("tabs",{"tabs--block":t},n),children:a.map((e=>{let{value:n,label:t,attributes:i}=e;return(0,b.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>{s.push(e)},onKeyDown:u,onClick:d,...i,className:(0,o.A)("tabs__item",_.tabItem,i?.className,{"tabs__item--active":r===n}),children:t??n},n)}))})}function w(e){let{lazy:n,children:t,selectedValue:i}=e;const l=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=l.find((e=>e.props.value===i));return e?(0,r.cloneElement)(e,{className:(0,o.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:l.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==i})))})}function v(e){const n=m(e);return(0,b.jsxs)("div",{className:(0,o.A)("tabs-container",_.tabList),children:[(0,b.jsx)(k,{...n,...e}),(0,b.jsx)(w,{...n,...e})]})}function x(e){const n=(0,f.A)();return(0,b.jsx)(v,{...e,children:u(e.children)},String(n))}},1184:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>a});var r=t(4041);const o={},i=r.createContext(o);function l(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),r.createElement(i.Provider,{value:n},e.children)}},4435:(e,n,t)=>{t.d(n,{A:()=>l});t(4041);var r=t(4357);const o={tabItem:"tabItem_OMyP"};var i=t(1085);function l(e){let{children:n,hidden:t,className:l}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,r.A)(o.tabItem,l),hidden:t,children:n})}},6069:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>u});const r=JSON.parse('{"id":"Whirlpools SDKs/Whirlpools Client","title":"Orca Whirlpools Client SDK","description":"Overview","source":"@site/docs/03-Whirlpools SDKs/03-Whirlpools Client.mdx","sourceDirName":"03-Whirlpools SDKs","slug":"/Whirlpools SDKs/Whirlpools Client","permalink":"/Whirlpools SDKs/Whirlpools Client","draft":false,"unlisted":false,"editUrl":"https://github.com/orca-so/whirlpools/tree/main/docs/whirlpool/docs/03-Whirlpools SDKs/03-Whirlpools Client.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_label":"Whirlpools Client"},"sidebar":"sidebar","previous":{"title":"Whirlpools Core","permalink":"/Whirlpools SDKs/Whirlpools Core"},"next":{"title":"Installation","permalink":"/Legacy SDK/Installation"}}');var o=t(1085),i=t(1184),l=t(95),a=t(4435);const s={sidebar_label:"Whirlpools Client"},c="Orca Whirlpools Client SDK",d={},u=[{value:"Overview",id:"overview",level:2},{value:"Key Features",id:"key-features",level:2},{value:"Installation:",id:"installation",level:2},{value:"Compatibility",id:"compatibility",level:3},{value:"Installation",id:"installation-1",level:3},{value:"Usage",id:"usage",level:2},{value:"Fetching Whirlpool Accounts with Filters",id:"fetching-whirlpool-accounts-with-filters",level:3},{value:"Deriving a PDA",id:"deriving-a-pda",level:3},{value:"Example: Initialize Pool Instruction",id:"example-initialize-pool-instruction",level:3}];function p(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"orca-whirlpools-client-sdk",children:"Orca Whirlpools Client SDK"})}),"\n",(0,o.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,o.jsx)(n.p,{children:"This SDK provides developers with low-level functionalities for interacting with the Whirlpool Program on Solana. It serves as a foundational tool that allows developers to manage and integrate detailed operations into their Typescript projects, particularly those related to Orca's Whirlpool Program. While a high-level SDK is available for easier integration, this package offers more granular control for advanced use cases."}),"\n",(0,o.jsx)(n.h2,{id:"key-features",children:"Key Features"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Codama Client"}),": The package includes a set of generated client code based on the Whirlpool Program IDL. This ensures all the necessary program information is easily accessible in a structured format and handles all decoding and encoding of instructions and account data, making it much easier to interact with the program."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"GPA (Get Program Accounts) Filters"}),": This feature contains utilities to add filters to program accounts, allowing developers to fetch program account data more selectively and efficiently."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"PDA (Program Derived Addresses) Utilities"}),": This feature contains utility functions that help derive Program Derived Addresses (PDAs) for accounts within the Whirlpool Program, simplifying address generation for developers."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"installation",children:"Installation:"}),"\n",(0,o.jsxs)(l.A,{groupId:"programming-languages",children:[(0,o.jsxs)(a.A,{value:"ts",label:"Typescript",default:!0,children:[(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"NOTE"}),": This SDK requires Solana Kit. It is not compatible with Solana Web3.js."]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"npm install @orca-so/whirlpools-client\n"})})]}),(0,o.jsxs)(a.A,{value:"rust",label:"Rust",children:[(0,o.jsx)(n.h3,{id:"compatibility",children:"Compatibility"}),(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Compatible with ",(0,o.jsx)(n.code,{children:"anchor"})," versions ",(0,o.jsx)(n.code,{children:"^0.26"})," but ",(0,o.jsx)(n.code,{children:"<0.30"}),". If you enable the ",(0,o.jsx)(n.code,{children:"anchor"})," feature of ",(0,o.jsx)(n.code,{children:"orca_whirlpools_client"})," in ",(0,o.jsx)(n.code,{children:"cargo.toml"})," while using a version of anchor that's ",(0,o.jsx)(n.code,{children:"^0.30"})," in your project, you may need to apply a lockfile patch to switch to a lower version:"]}),"\n"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"cargo update anchor:<current-version> --precise 0.29\n"})}),(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Compatible with ",(0,o.jsx)(n.code,{children:"solana-program"})," versions ",(0,o.jsx)(n.code,{children:"^1.18.0"})," but ",(0,o.jsx)(n.code,{children:"<3.0.0"}),". By default, Cargo will install the latest version of Solana SDK ",(0,o.jsx)(n.code,{children:"^v2"}),". This can cause dependcy issues when using older versions. To solve this you can apply a lockfile patch with the following command:","\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"cargo update solana-program:<current-version> --precise <required-version>\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["NOTE: if you are dealing with compatibility issues for both ",(0,o.jsx)(n.code,{children:"anchor"})," and ",(0,o.jsx)(n.code,{children:"solana-program"}),", the order of the patches matters. First patch ",(0,o.jsx)(n.code,{children:"anchor"}),", then patch ",(0,o.jsx)(n.code,{children:"solana-program"}),"."]}),"\n"]}),(0,o.jsx)(n.h3,{id:"installation-1",children:"Installation"}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"cargo add orca_whirlpools_client\n"})})]})]}),"\n",(0,o.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,o.jsx)(n.p,{children:"Here are some basic examples of how to use the package."}),"\n",(0,o.jsx)(n.h3,{id:"fetching-whirlpool-accounts-with-filters",children:"Fetching Whirlpool Accounts with Filters"}),"\n",(0,o.jsx)(n.p,{children:"The following example demonstrates how to fetch Whirlpools accounts based on specific filters, using the GPA utilities:"}),"\n",(0,o.jsxs)(l.A,{groupId:"programming-languages",children:[(0,o.jsx)(a.A,{value:"ts",label:"Typescript",default:!0,children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",children:'import { createSolanaRpc, address, devnet } from \'@solana/kit\';\nimport { fetchAllWhirlpoolWithFilter, whirlpoolTokenMintAFilter } from "@orca-so/whirlpools-client";\n\nconst rpc = createSolanaRpc(devnet("https://api.devnet.solana.com"));\n\nconst tokenMintA = address("BRjpCHtyQLNCo8gqRUr8jtdAj5AjPYQaoqbvcZiHok1k"); //DevUSDC\nconst filter = whirlpoolTokenMintAFilter(tokenMintA);\n\nconst accounts = await fetchAllWhirlpoolWithFilter(rpc, filter);\nconsole.log(accounts);\n'})})}),(0,o.jsx)(a.A,{value:"rust",label:"Rust",children:(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"orca_whirlpools_client"})," currently does not support fetching accounts with filters."]})})]}),"\n",(0,o.jsx)(n.h3,{id:"deriving-a-pda",children:"Deriving a PDA"}),"\n",(0,o.jsxs)(n.p,{children:["To derive a PDA for a Whirlpool account, you can use the ",(0,o.jsx)(n.code,{children:"getWhirlpoolAddress"})," PDA utility."]}),"\n",(0,o.jsxs)(l.A,{groupId:"programming-languages",children:[(0,o.jsx)(a.A,{value:"ts",label:"Typescript",default:!0,children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",children:'import { getWhirlpoolAddress } from "@orca-so/whirlpools-client";\nimport { address } from \'@solana/kit\';\n\nconst whirlpoolConfigAddress = address("FcrweFY1G9HJAHG5inkGB6pKg1HZ6x9UC2WioAfWrGkR");\nconst tokenMintA = address("So11111111111111111111111111111111111111112"); //wSOL\nconst tokenMintB = address("BRjpCHtyQLNCo8gqRUr8jtdAj5AjPYQaoqbvcZiHok1k"); //DevUSDC\nconst tickSpacing = 64;\n\nconst whirlpoolPda = await getWhirlpoolAddress(\n    whirlpoolConfigAddress,\n    tokenMintA,\n    tokenMintB,\n    tickSpacing,\n);\nconsole.log(whirlpoolPda);\n'})})}),(0,o.jsx)(a.A,{value:"rust",label:"Rust",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-rust",children:'use orca_whirlpools_client::get_whirlpool_address;\nuse solana_sdk::pubkey::Pubkey;\nuse std::str::FromStr;\n\nfn main() {\n    let whirlpool_config_address = Pubkey::from_str("FcrweFY1G9HJAHG5inkGB6pKg1HZ6x9UC2WioAfWrGkR").unwrap();\n    let token_mint_a = Pubkey::from_str("So11111111111111111111111111111111111111112").unwrap(); // wSOL\n    let token_mint_b = Pubkey::from_str("BRjpCHtyQLNCo8gqRUr8jtdAj5AjPYQaoqbvcZiHok1k").unwrap(); // DevUSDC\n    let tick_spacing = 64;\n\n    let (whirlpool_pda, _bump) = get_whirlpool_address(&whirlpool_config_address, &token_mint_a, &token_mint_b, tick_spacing).unwrap();\n    println!("{:?}", whirlpool_pda);\n}\n'})})})]}),"\n",(0,o.jsx)(n.h3,{id:"example-initialize-pool-instruction",children:"Example: Initialize Pool Instruction"}),"\n",(0,o.jsx)(n.p,{children:"The following example demonstrates how to create an InitializePool instruction using the Codama-IDL autogenerated code:"}),"\n",(0,o.jsxs)(l.A,{groupId:"programming-languages",children:[(0,o.jsx)(a.A,{value:"ts",label:"Typescript",default:!0,children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",children:'import { getInitializePoolV2Instruction, getTokenBadgeAddress, getWhirlpoolAddress, getFeeTierAddress } from "@orca-so/whirlpools-client";\nimport { address, generateKeyPairSigner } from \'@solana/kit\';\n\nconst whirlpoolConfigAddress = address("FcrweFY1G9HJAHG5inkGB6pKg1HZ6x9UC2WioAfWrGkR");\nconst tokenMintA = address("So11111111111111111111111111111111111111112"); // wSOL\nconst tokenMintB = address("BRjpCHtyQLNCo8gqRUr8jtdAj5AjPYQaoqbvcZiHok1k"); // DevUSDC\nconst tokenBadgeA = await getTokenBadgeAddress(whirlpoolConfigAddress, tokenMintA)\nconst tokenBadgeB = await getTokenBadgeAddress(whirlpoolConfigAddress, tokenMintB)\nconst wallet = await generateKeyPairSigner(); // CAUTION: this wallet is not persistent\nconst tickSpacing = 8;\nconst whirlpool = await getWhirlpoolAddress(whirlpoolConfigAddress, tokenMintA, tokenMintB, tickSpacing);\nconst tokenVaultA = await generateKeyPairSigner();\nconst tokenVaultB = await generateKeyPairSigner();\nconst feeTier = await getFeeTierAddress(whirlpoolConfigAddress, tickSpacing);\nconst tokenProgramA = address("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA");\nconst tokenProgramB = address("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA");\nconst initialSqrtPrice = BigInt(7459106261056563200n);\n\nconst initializePoolInstruction = getInitializePoolV2Instruction({\n  whirlpoolsConfig: whirlpoolConfigAddress,\n  tokenMintA,\n  tokenMintB,\n  tokenBadgeA,\n  tokenBadgeB,\n  funder: wallet,\n  whirlpool,\n  tokenVaultA,\n  tokenVaultB,\n  feeTier,\n  whirlpoolBump: 1,\n  tickSpacing,\n  tokenProgramA,\n  tokenProgramB,\n  initialSqrtPrice\n});\n\nconsole.log(initializePoolInstruction);\n'})})}),(0,o.jsx)(a.A,{value:"rust",label:"Rust",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-rust",children:'use orca_whirlpools_client::{\n    instructions::InitializePoolV2Builder,\n    get_fee_tier_address,\n    get_token_badge_address,\n    get_whirlpool_address,\n};\nuse solana_sdk::{\n    pubkey::Pubkey,\n    signer::{keypair::Keypair, Signer},\n};\nuse std::str::FromStr;\n\nfn main() {\n    let whirlpool_config_address = Pubkey::from_str("FcrweFY1G9HJAHG5inkGB6pKg1HZ6x9UC2WioAfWrGkR").unwrap();\n    let token_mint_a = Pubkey::from_str("So11111111111111111111111111111111111111112").unwrap(); // wSOL\n    let token_mint_b = Pubkey::from_str("BRjpCHtyQLNCo8gqRUr8jtdAj5AjPYQaoqbvcZiHok1k").unwrap(); // DevUSDC\n    let (token_badge_a, _bump) = get_token_badge_address(&whirlpool_config_address, &token_mint_a).unwrap();\n    let (token_badge_b, _bump) = get_token_badge_address(&whirlpool_config_address, &token_mint_b).unwrap();\n    let wallet = Keypair::new(); // CAUTION: this wallet is not persistent\n    let tick_spacing = 8;\n    let (whirlpool_pda, _bump) = get_whirlpool_address(&whirlpool_config_address, &token_mint_a, &token_mint_b, tick_spacing).unwrap();\n    let token_vault_a = Keypair::new();\n    let token_vault_b = Keypair::new();\n    let (fee_tier, _bump) = get_fee_tier_address(&whirlpool_config_address, tick_spacing).unwrap();\n    let token_program_a = Pubkey::from_str("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA").unwrap();\n    let token_program_b = Pubkey::from_str("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA").unwrap();\n    let initial_sqrt_price = 7459106261056563200u128;\n\n    let initialize_pool_v2_instruction = InitializePoolV2Builder::new()\n        .whirlpools_config(whirlpool_config_address)\n        .token_mint_a(token_mint_a)\n        .token_mint_b(token_mint_b)\n        .token_badge_a(token_badge_a)\n        .token_badge_b(token_badge_b)\n        .funder(wallet.pubkey())\n        .whirlpool(whirlpool_pda)\n        .token_vault_a(token_vault_a.pubkey())\n        .token_vault_b(token_vault_b.pubkey())\n        .fee_tier(fee_tier)\n        .token_program_a(token_program_a)\n        .token_program_b(token_program_b)\n        .tick_spacing(tick_spacing)\n        .initial_sqrt_price(initial_sqrt_price)\n        .instruction();\n\n    println!("{:?}", initialize_pool_v2_instruction);\n}\n'})})})]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(p,{...e})}):p(e)}}}]);