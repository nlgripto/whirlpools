"use strict";(self.webpackChunk_orca_so_whirlpools_docs=self.webpackChunk_orca_so_whirlpools_docs||[]).push([[2787],{95:(e,t,n)=>{n.d(t,{A:()=>j});var o=n(4041),s=n(4357),i=n(5245),r=n(6090),l=n(3190),a=n(838),u=n(6423),c=n(6326);function d(e){return o.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,o.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:t,children:n}=e;return(0,o.useMemo)((()=>{const e=t??function(e){return d(e).map((e=>{let{props:{value:t,label:n,attributes:o,default:s}}=e;return{value:t,label:n,attributes:o,default:s}}))}(n);return function(e){const t=(0,u.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function h(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function f(e){let{queryString:t=!1,groupId:n}=e;const s=(0,r.W6)(),i=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,a.aZ)(i),(0,o.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(s.location.search);t.set(i,e),s.replace({...s.location,search:t.toString()})}),[i,s])]}function m(e){const{defaultValue:t,queryString:n=!1,groupId:s}=e,i=p(e),[r,a]=(0,o.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!h({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const o=n.find((e=>e.default))??n[0];if(!o)throw new Error("Unexpected error: 0 tabValues");return o.value}({defaultValue:t,tabValues:i}))),[u,d]=f({queryString:n,groupId:s}),[m,g]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[s,i]=(0,c.Dv)(n);return[s,(0,o.useCallback)((e=>{n&&i.set(e)}),[n,i])]}({groupId:s}),w=(()=>{const e=u??m;return h({value:e,tabValues:i})?e:null})();(0,l.A)((()=>{w&&a(w)}),[w]);return{selectedValue:r,selectValue:(0,o.useCallback)((e=>{if(!h({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);a(e),d(e),g(e)}),[d,g,i]),tabValues:i}}var g=n(1310);const w={tabList:"tabList_M0Dn",tabItem:"tabItem_ysIP"};var v=n(1085);function b(e){let{className:t,block:n,selectedValue:o,selectValue:r,tabValues:l}=e;const a=[],{blockElementScrollPositionUntilNextRender:u}=(0,i.a_)(),c=e=>{const t=e.currentTarget,n=a.indexOf(t),s=l[n].value;s!==o&&(u(t),r(s))},d=e=>{let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const n=a.indexOf(e.currentTarget)+1;t=a[n]??a[0];break}case"ArrowLeft":{const n=a.indexOf(e.currentTarget)-1;t=a[n]??a[a.length-1];break}}t?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},t),children:l.map((e=>{let{value:t,label:n,attributes:i}=e;return(0,v.jsx)("li",{role:"tab",tabIndex:o===t?0:-1,"aria-selected":o===t,ref:e=>{a.push(e)},onKeyDown:d,onClick:c,...i,className:(0,s.A)("tabs__item",w.tabItem,i?.className,{"tabs__item--active":o===t}),children:n??t},t)}))})}function y(e){let{lazy:t,children:n,selectedValue:i}=e;const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=r.find((e=>e.props.value===i));return e?(0,o.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:r.map(((e,t)=>(0,o.cloneElement)(e,{key:t,hidden:e.props.value!==i})))})}function x(e){const t=m(e);return(0,v.jsxs)("div",{className:(0,s.A)("tabs-container",w.tabList),children:[(0,v.jsx)(b,{...t,...e}),(0,v.jsx)(y,{...t,...e})]})}function j(e){const t=(0,g.A)();return(0,v.jsx)(x,{...e,children:d(e.children)},String(t))}},1184:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>l});var o=n(4041);const s={},i=o.createContext(s);function r(e){const t=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),o.createElement(i.Provider,{value:t},e.children)}},4435:(e,t,n)=>{n.d(t,{A:()=>r});n(4041);var o=n(4357);const s={tabItem:"tabItem_OMyP"};var i=n(1085);function r(e){let{children:t,hidden:n,className:r}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,o.A)(s.tabItem,r),hidden:n,children:t})}},6071:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>u,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"Whirlpools SDKs/Whirlpools/Position Management/Close Position","title":"Close a Position","description":"Once you\'ve provided liquidity in a pool, there may come a time when you want to close your position entirely. The SDK allows you to fully remove liquidity from the pool, collect any outstanding fees and rewards, and close the position. This is useful when you want to exit the pool, either to realize profits or to reallocate capital to other opportunities.","source":"@site/docs/03-Whirlpools SDKs/01-Whirlpools/04-Position Management/05-Close Position.mdx","sourceDirName":"03-Whirlpools SDKs/01-Whirlpools/04-Position Management","slug":"/Whirlpools SDKs/Whirlpools/Position Management/Close Position","permalink":"/Whirlpools SDKs/Whirlpools/Position Management/Close Position","draft":false,"unlisted":false,"editUrl":"https://github.com/orca-so/whirlpools/tree/main/docs/whirlpool/docs/03-Whirlpools SDKs/01-Whirlpools/04-Position Management/05-Close Position.mdx","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_label":"Close Position"},"sidebar":"sidebar","previous":{"title":"Harvest","permalink":"/Whirlpools SDKs/Whirlpools/Position Management/Harvest"},"next":{"title":"Trade","permalink":"/Whirlpools SDKs/Whirlpools/Trade"}}');var s=n(1085),i=n(1184),r=n(95),l=n(4435);const a={sidebar_label:"Close Position"},u="Close a Position",c={},d=[{value:"1. Overview of Closing a Position",id:"1-overview-of-closing-a-position",level:2},{value:"2. Getting Started Guide",id:"2-getting-started-guide",level:2},{value:"Closing a Position",id:"closing-a-position",level:3},{value:"3. Usage Example",id:"3-usage-example",level:2}];function p(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"close-a-position",children:"Close a Position"})}),"\n",(0,s.jsx)(t.p,{children:"Once you've provided liquidity in a pool, there may come a time when you want to close your position entirely. The SDK allows you to fully remove liquidity from the pool, collect any outstanding fees and rewards, and close the position. This is useful when you want to exit the pool, either to realize profits or to reallocate capital to other opportunities."}),"\n",(0,s.jsx)(t.p,{children:"This guide explains how to use the SDK to close a position."}),"\n",(0,s.jsx)(t.h2,{id:"1-overview-of-closing-a-position",children:"1. Overview of Closing a Position"}),"\n",(0,s.jsx)(t.p,{children:"When using the SDK to fully close a liquidity position, you generate all the necessary instructions. It performs the following key actions:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"Collect Fees: Retrieves any fees earned from trades involving your liquidity."}),"\n",(0,s.jsx)(t.li,{children:"Collect Rewards: Retrieves any rewards you've accumulated for the pool."}),"\n",(0,s.jsx)(t.li,{children:"Decrease Liquidity: Removes any remaining liquidity in the position."}),"\n",(0,s.jsx)(t.li,{children:"Close Position: Closes the position and returns the tokens in your account."}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"2-getting-started-guide",children:"2. Getting Started Guide"}),"\n",(0,s.jsx)(t.h3,{id:"closing-a-position",children:"Closing a Position"}),"\n",(0,s.jsx)(t.p,{children:"To close a position and withdraw all liquidity, follow these steps:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"RPC Client"}),": Use a Solana RPC client to interact with the blockchain."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Position Mint"}),": Provide the mint address of the NFT representing your position. This NFT serves as proof of ownership and represents the liquidity in the position."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Parameters for Liquidity"}),": Define the parameters for decreasing liquidity. This can be specified as a liquidity amount or as specific token amounts."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Slippage Tolerance"}),": Set the maximum slippage tolerance (optional, defaults to 1%). Slippage refers to the difference between the expected token amounts you receive when closing a position and the actual amounts returned to your wallet. A lower slippage tolerance reduces the risk of receiving fewer tokens than expected but may lead to failed transactions if the market moves too quickly. For example, if you expect to receive 100 units of Token A and 1,000 units of Token B when closing your position, with a 1% slippage tolerance, the minimum amounts returned would be 99 Token A and 990 Token B."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Authority"}),": This can be your wallet, which will fund the pool initialization. If the authority is not specified, the default wallet will be used. You can configure the default wallet through the SDK."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Create Instructions"}),": Use the appropriate function to generate the necessary instructions."]}),"\n"]}),"\n",(0,s.jsxs)(r.A,{groupId:"programming-languages",children:[(0,s.jsx)(l.A,{value:"ts",label:"Typescript",default:!0,children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-tsx",children:"import { closePositionInstructions, setWhirlpoolsConfig } from '@orca-so/whirlpools';\nimport { createSolanaRpc, devnet, address } from '@solana/kit';\nimport { loadWallet } from './utils';\n\nawait setWhirlpoolsConfig('solanaDevnet');\nconst devnetRpc = createSolanaRpc(devnet('https://api.devnet.solana.com'));\nconst wallet = await loadWallet();\nconst positionMint = address(\"HqoV7Qv27REUtmd9UKSJGGmCRNx3531t33bDG1BUfo9K\");\n\nconst { instructions, quote, feesQuote, rewardsQuote } = await closePositionInstructions(\n  devnetRpc,\n  positionMint,\n  100,\n  wallet\n);\n\nconsole.log(`Quote token max B: ${quote.tokenEstB}`);\nconsole.log(`Fees owed token A: ${feesQuote.feeOwedA}`);\nconsole.log(`Rewards '1' owed: ${rewardsQuote.rewards[0].rewardsOwed}`);\nconsole.log(`Number of instructions:, ${instructions.length}`);\n"})})}),(0,s.jsx)(l.A,{value:"rust",label:"Rust",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-rust",children:'use crate::utils::load_wallet;\nuse orca_whirlpools::{\n    close_position_instructions, set_whirlpools_config_address, WhirlpoolsConfigInput,\n};\nuse solana_client::nonblocking::rpc_client::RpcClient;\nuse solana_sdk::pubkey::Pubkey;\nuse std::str::FromStr;\n\n#[tokio::main]\nasync fn main() {\n    set_whirlpools_config_address(WhirlpoolsConfigInput::SolanaDevnet).unwrap();\n    let rpc = RpcClient::new("https://api.devnet.solana.com".to_string());\n    let wallet = load_wallet();\n\n    let position_mint_address =\n        Pubkey::from_str("HqoV7Qv27REUtmd9UKSJGGmCRNx3531t33bDG1BUfo9K").unwrap();\n\n    let result = close_position_instructions(\n        &rpc,\n        position_mint_address,\n        Some(100),\n        Some(wallet.pubkey()),\n    )\n    .await\n    .unwrap();\n\n    println!("Quote token max B: {:?}", result.quote.token_est_b);\n    println!("Fees Quote: {:?}", result.fees_quote);\n    println!("Rewards Quote: {:?}", result.rewards_quote);\n    println!("Number of Instructions: {}", result.instructions.len());\n}\n'})})})]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-tsx",children:"const { instructions, quote, feesQuote, rewardsQuote } = await closePositionInstructions(\n  rpc,\n  positionMint,\n  slippageTolerance,\n  wallet\n);\n"})}),"\n",(0,s.jsxs)(t.ol,{start:"7",children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Submit Transaction"}),": Include the generated instructions in a Solana transaction and send it to the network using the Solana SDK."]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"3-usage-example",children:"3. Usage Example"}),"\n",(0,s.jsx)(t.p,{children:"Suppose your trading strategy predicts that the current price range will lead to divergence loss, and you need to close the position to avoid further losses. Using the SDK, you can generate the instructions to collect all accumulated fees, rewards, and remove liquidity to prevent further losses."})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}}}]);